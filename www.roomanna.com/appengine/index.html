<!DOCTYPE html>
<html>
  <head>
    <title>roomanna.com</title>
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/fonts.css">
    <script src="js/roomanna.js"></script>
    <script>
      var stepInterval = null;
      var manager = null;
      var x = null;
      var y = null;
      
      function step() {
        if (manager.step() == false) {
          window.clearInterval(stepInterval);
          stepInterval = null;
        }
        manager.draw();
      };
      
      function startStepping() {
        if (!stepInterval) {
          stepInterval = window.setInterval(step, 40);
        }
      };
      
      function onMouseMove(evt) {
        if (x == null || y == null) {
          x = evt.pageX;
          y = evt.pageY;
        } else {
          deltaX = Math.abs(evt.pageX - x);
          deltaY = Math.abs(evt.pageY - y);
          if (deltaX > 5 || deltaY > 5) {
            window.removeEventListener('mousemove', onMouseMove, false);
            startStepping();
          }
        }
      };  
      
      function onClick(evt) {
        console.log(evt);
        manager.onClick(evt.offsetX, evt.offsetY);
        startStepping();
      };   
      
      function onSelectStart(evt) {
        evt.preventDefault();
        return false;
      };
      
      window.addEventListener('load', function() {        
        window.setTimeout(function() {
          var text = new TextMapper(80, 20);
          text.drawText('roomanna.com');
          manager = new CanvasManager(800, 200);
          document.getElementById('canvas').appendChild(manager.canvas);
          manager.canvas.addEventListener('click', onClick, false);
          manager.canvas.addEventListener('selectstart', onSelectStart, false);
          manager.addPoints(text.canvas);
          manager.draw();
          window.addEventListener('mousemove', onMouseMove, false);            
        }, 100);
      }, false);
    </script>
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-5452579-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>
  <body>
    <div id="canvas">
    </div>
    <div class="texty">
      <strong>Hello</strong>, I've got a <a href="http://blog.roomanna.com">blog</a> now.
    </div>
    <div id="fonty">roomanna.com</div>
  </body>
</html>